#!/usr/bin/env bash

set -e

# Config
BOIL_URL="https://raw.githubusercontent.com/idandrori555/boil/refs/heads/main/boil"
INSTALL_DIR="$HOME/.boil"   # folder for templates
BIN_DIR="/usr/local/bin"    # global location
BOIL_TMP="$(mktemp)"        # temporary file for downloading

# 1. Create templates folder
if [ ! -d "$INSTALL_DIR" ]; then
  mkdir -p "$INSTALL_DIR"
  echo "‚úÖ Created templates directory at $INSTALL_DIR"
else
  echo "‚ÑπÔ∏è Templates directory already exists at $INSTALL_DIR"
fi

# 2. Download boil
echo "‚¨áÔ∏è Downloading 'boil' from GitHub..."
curl -fsSL "$BOIL_URL" -o "$BOIL_TMP"
chmod +x "$BOIL_TMP"
echo "‚úÖ Downloaded 'boil'"

# 3. Copy to /usr/local/bin
if [ "$(id -u)" -ne 0 ]; then
  echo "‚ö†Ô∏è Copying to $BIN_DIR requires sudo privileges."
  sudo cp "$BOIL_TMP" "$BIN_DIR/boil"
  sudo chown "$(whoami)" "$BIN_DIR/boil"
else
  cp "$BOIL_TMP" "$BIN_DIR/boil"
fi
chmod +x "$BIN_DIR/boil"

# 4. Clean up
rm -f "$BOIL_TMP"

echo "‚úÖ Installed 'boil' to $BIN_DIR"
echo "üéâ Installation complete! You can now run 'boil <template-name>' from anywhere."
echo "Templates folder: $INSTALL_DIR"

